<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="pandoc.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  <!DOCTYPE html>
  <html>
  <head>
      <style type="text/css">
          body {
          }
          #cover {
              border: 1px solid lightgray;
          }
      </style>
  </head>
  <body onload="getPdfInfo()">
      <h1>ezzing3DLayout</h1>
      <h2>PV planning tool - API Documentation</h2>
  
      <img id="cover" class="w100" src="./doc_templates/portada.jpg" alt="ezzing3DLayout Documentation" />
  
      <h1>Table of contents</h1>
  </body>
  </html>
</head>
<body>
<nav id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#screenshots">Screenshots</a></li>
<li><a href="#dlayout-interface">3DLayout Interface</a><ul>
<li><a href="#aside-panel">Aside Panel</a></li>
<li><a href="#canvas-area">Canvas Area</a><ul>
<li><a href="#buildings-index">Buildings Index</a></li>
<li><a href="#main-options">Main Options</a></li>
<li><a href="#control-buttons">Control Buttons</a></li>
</ul></li>
</ul></li>
<li><a href="#keepouts">Keepouts</a><ul>
<li><a href="#keepout-height-calculations">Keepout height calculations</a></li>
<li><a href="#invisible-keepouts">Invisible keepouts</a></li>
<li><a href="#crop-keepout-to-the-building-shape">Crop keepout to the building shape</a></li>
</ul></li>
<li><a href="#subareas">Subareas</a><ul>
<li><a href="#subarea-creation">Subarea creation</a></li>
<li><a href="#add-subarea">Add subarea</a><ul>
<li><a href="#crop-subarea-to-the-area-shape">Crop subarea to the area shape</a></li>
<li><a href="#edit-subarea-vertices">Edit subarea vertices</a></li>
<li><a href="#remove-subarea">Remove subarea</a></li>
</ul></li>
</ul></li>
<li><a href="#layout-coordinate-systems">Layout Coordinate Systems</a><ul>
<li><a href="#world-coordinate-system">World Coordinate System</a></li>
<li><a href="#scene-coordinate-system">Scene Coordinate System</a></li>
<li><a href="#building-coordinate-system">Building Coordinate System</a></li>
<li><a href="#area-coordinate-system">Area Coordinate System</a></li>
</ul></li>
<li><a href="#how-to-use">How to use</a><ul>
<li><a href="#api-key-and-autentication">Api key and autentication</a></li>
<li><a href="#dom-element">DOM element</a></li>
<li><a href="#basic-functions">Basic functions</a><ul>
<li><a href="#createlayout">createLayout</a></li>
<li><a href="#getlayout">getLayout</a></li>
<li><a href="#listlayouts">listLayouts</a></li>
<li><a href="#loadlayout">loadLayout</a></li>
</ul></li>
<li><a href="#showcase-mode">Showcase mode</a><ul>
<li><a href="#showcase-without-camera-spin">Showcase without camera spin</a></li>
<li><a href="#showcase-with-camera-spin">Showcase with camera spin</a></li>
</ul></li>
</ul></li>
<li><a href="#dlayout-communication-system">3DLayout Communication System</a><ul>
<li><a href="#info-events-sent-by-3dlayout">Info Events sent by 3DLayout</a><ul>
<li><a href="#zoomchanged">zoomChanged</a></li>
<li><a href="#fullscreen">fullscreen</a></li>
<li><a href="#tabchanged">tabChanged</a></li>
<li><a href="#editarea">editArea</a></li>
<li><a href="#editkeepout">editKeepout</a></li>
<li><a href="#edittree">editTree</a></li>
<li><a href="#areachanged">areaChanged</a></li>
<li><a href="#buildingchanged">buildingChanged</a></li>
<li><a href="#roofchanged">roofChanged</a></li>
<li><a href="#editroof">editRoof</a></li>
<li><a href="#editvertices">editVertices</a></li>
<li><a href="#buildingremoved">buildingRemoved</a></li>
<li><a href="#buildingselected">buildingSelected</a></li>
<li><a href="#buildingcreated">buildingCreated</a></li>
</ul></li>
<li><a href="#functions-to-retrieve-info-from-3dlayout">Functions to retrieve info from 3DLayout</a><ul>
<li><a href="#generic-functions">Generic Functions</a></li>
<li><a href="#building-related-functions">Building related functions</a></li>
<li><a href="#area-related-functions">Area related functions</a></li>
<li><a href="#subarea-related-functions">Subarea related functions</a></li>
</ul></li>
<li><a href="#functions-to-send-info-to-the-3dlayout">Functions to send info to the 3DLayout</a><ul>
<li><a href="#customalert-event">CustomAlert event</a></li>
</ul></li>
</ul></li>
<li><a href="#layout-rules">Layout Rules</a><ul>
<li><a href="#special-behaviours">Special Behaviours</a><ul>
<li><a href="#perspective">Perspective</a></li>
<li><a href="#spin">Spin</a></li>
<li><a href="#read-only">Read only</a></li>
<li><a href="#showcase">Showcase</a></li>
<li><a href="#zoom">zoom</a></li>
<li><a href="#logo">logo</a></li>
<li><a href="#azimuthoffset">azimuthOffset</a></li>
</ul></li>
<li><a href="#default-values">Default Values</a><ul>
<li><a href="#modules">modules</a></li>
<li><a href="#defaultroofs">DefaultRoofs</a></li>
<li><a href="#defaultbuilding">DefaultBuilding</a></li>
<li><a href="#custompalette">CustomPalette</a></li>
<li><a href="#maxbuildingheight">maxBuildingHeight</a></li>
</ul></li>
<li><a href="#custom-buttons">Custom Buttons</a><ul>
<li><a href="#mainoptionscustombuttons">MainoptionsCustomButtons</a></li>
<li><a href="#controlcustombuttons">ControlCustomButtons</a></li>
</ul></li>
<li><a href="#custom-logo">Custom Logo</a></li>
<li><a href="#custom-loading-animation">Custom Loading Animation</a></li>
<li><a href="#custom-logo-in-tutorial-section">Custom Logo in tutorial section</a></li>
<li><a href="#customize-go-back-button-in-the-tutorial-menu">Customize Go back button in the tutorial menu</a></li>
</ul></li>
<li><a href="#changelog">Changelog</a><ul>
<li><a href="#section">[2.15.0] - 2017-02-01 - ?????????????????????????</a><ul>
<li><a href="#added">Added</a></li>
</ul></li>
<li><a href="#section-1">[2.11.0] - 2016-11-04</a><ul>
<li><a href="#changed">Changed</a></li>
<li><a href="#fixed">Fixed</a></li>
</ul></li>
<li><a href="#section-2">[2.10.0] - 2016-10-21</a><ul>
<li><a href="#added-1">Added</a></li>
<li><a href="#fixed-1">Fixed</a></li>
<li><a href="#deprecated">Deprecated</a></li>
<li><a href="#changed-1">Changed</a></li>
</ul></li>
<li><a href="#section-3">[2.9.1] - 2016-09-19</a><ul>
<li><a href="#fixed-2">Fixed</a></li>
</ul></li>
<li><a href="#section-4">[2.9.0] - 2016-09-18</a><ul>
<li><a href="#fixed-3">Fixed</a></li>
</ul></li>
<li><a href="#section-5">[2.8.0] - 2016-09-14</a><ul>
<li><a href="#changed-2">Changed</a></li>
</ul></li>
<li><a href="#section-6">[2.7.0] - 2016-09-09</a></li>
<li><a href="#added-2">added</a><ul>
<li><a href="#changed-3">Changed</a></li>
<li><a href="#fixed-4">Fixed</a></li>
</ul></li>
<li><a href="#section-7">[2.6.0] - 2016-09-01</a><ul>
<li><a href="#added-3">added</a></li>
<li><a href="#changed-4">changed</a></li>
<li><a href="#fixed-5">fixed</a></li>
<li><a href="#deprecated-1">deprecated</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="introduction">Introduction</h1>
<p>Ezzing 3DLayout is a PV planning tool that allows you to generate a 3d model of a building based on a satellite image. You can model any number of buildings, select between up to five different type of roofs, define keepouts and trees with custom heights…</p>
<p>Inside each roof area you can customize different structures, select module models and get automated previews of your setup.</p>
<p>It also provides you with a perspective view and a sun simulator to determine where the shadows will be in your installation.</p>
<p>Ezzing 3DLayout is an embebible webapp. You can integrate it inside your own system and customize many elements inside, from module models to prefered default settings for each roof type.</p>
<p>In this document you will find a brief showcase of the different areas of the app, a technical explanation on how to integrate this webapp inside your platform, a full description of the API that will allow you to communicate with the 3DLayout, and finally a description on how to customize different parts of the app.</p>
<p><img class="w100" src="./layout-doc-imgs/new-img/intro.png" alt="3DLayout" /><br />
<br></p>
<p>You can test the app by visiting this link:</p>
<p><a href="https://layout.ezzing.com/#/demo">https://layout.ezzing.com/#/demo</a></li></p>
<p>Also you can follow a tutorial to learn the basics of the 3DLayout in this link:</p>
<p><a href="https://layout.ezzing.com/#/tutorial">https://layout.ezzing.com/#/tutorial</a></li></p>
<div class="page-break"></div>
<h1 id="screenshots">Screenshots</h1>
<p><img class="w100" src="./layout-doc-imgs/new-img/perspective-view.png" alt="perspective view" /></p>
<p><img class="w100" src="./layout-doc-imgs/new-img/sun-simulation.png" alt="sun simulation" /></p>
<div class="page-break"></div>
<h1 id="dlayout-interface">3DLayout Interface</h1>
<p>The 3DLayout interface has two diferent parts: the <strong>aside panel</strong> and the <strong>canvas area</strong>.</p>
<h2 id="aside-panel">Aside Panel</h2>
<p>In the aside panel you can find functionalities related to the current active building and other objects in the scene.</p>
<p><br></p>
<p><img class="w100" src="./layout-doc-imgs/new-img/tab-building.png" alt="tab building" /></p>
<p><img class="w100" src="./layout-doc-imgs/new-img/tab-areas-1.png" alt="tab areas 1" /></p>
<p><img class="w100" src="./layout-doc-imgs/new-img/tab-areas-2.png" alt="tab areas 2" /></p>
<p><img class="w100" src="./layout-doc-imgs/new-img/tab-keepouts.png" alt="tab keepouts" /></p>
<p><img class="w100" src="./layout-doc-imgs/new-img/tab-trees.png" alt="tab trees" /></p>
<div class="page-break"></div>
<h2 id="canvas-area">Canvas Area</h2>
<p>In the canvas area you can see the satellite view and three different sets of elements: the <strong>buildings index</strong> on the left side, the <strong>main options buttons</strong> on the top, and the <strong>control buttons</strong> on the bottom-right corner.</p>
<p><img class="w100" src="./layout-doc-imgs/new-img/canvas.png" alt="canvas" /></p>
<div class="page-break"></div>
<h3 id="buildings-index">Buildings Index</h3>
<p>In the buildings index you can see the active building and select another one to become active.</p>
<p><img class="w200px" src="./layout-doc-imgs/new-img/buildings-index.png" alt="buildings-index" /></p>
<p><br></p>
<h3 id="main-options">Main Options</h3>
<p>These are the main options in the canvas area.</p>
<p><img class="w100" src="./layout-doc-imgs/new-img/mainoptions.png" alt="mainoptions" /></p>
<p>All this buttons are the <strong>main options custom buttons</strong>. You can customize this set of buttons by hidding some of them, by sorting them, or by adding new buttons.</p>
<p>The default custom buttons are:</p>
<ul>
<li>Save</li>
<li>Search address</li>
<li>Snapshot</li>
<li>Fullscreen</li>
<li>Sun simulation</li>
<li>Perspective view</li>
<li>Renderer</li>
<li>Satellite provider selector (only showed if available)</li>
</ul>
<blockquote>
<p>Please, visit the section <a href="#custom-buttons">Custom Buttons</a> to learn how to add your own buttons.</p>
</blockquote>
<h3 id="control-buttons">Control Buttons</h3>
<p>These are map related buttons. You can also customize the upper section of this set of buttons by hidding some of them or by adding new buttons.</p>
<p><img class="w75px" src="./layout-doc-imgs/new-img/controlbuttons1.png" alt="controlbuttons1" /></p>
<p>Fixed buttons in this area:</p>
<ul>
<li>Zoom in</li>
<li>Zoom out</li>
</ul>
<p><img class="w75px" src="./layout-doc-imgs/new-img/controlbuttons2.png" alt="controlbuttons2" /><br />
3D control custom buttons:</p>
<ul>
<li>Compass</li>
<li>Geolocation</li>
<li>Zoom in</li>
<li>Zoom out</li>
</ul>
<blockquote>
<p>Please, visit the section <a href="#custom-buttons">Custom Buttons</a> to learn how to add your own functions.</p>
</blockquote>
<div class="page-break"></div>
<h1 id="keepouts">Keepouts</h1>
<h2 id="keepout-height-calculations">Keepout height calculations</h2>
<p>When creating keepouts, please note the height selected for the keepout is not always the final keepout height.</p>
<p>Depending on the roof inclination and the keepout dimensions and positions, there is a minimum keepout height to avoid keepouts under the roof surface.<br />
<!-- FIX
Let's see an example:

<img class="w100" src="./layout-doc-imgs/imgs-sin-monitor/keeoput-height-scheme.jpg" alt="keeoput-height-scheme" />

In keepout 1, A is the desired height, and B is the minimum height for this keepout. As A is bigger than B then the keepout is created with the desired height (A).

In keepout 2, A is also the desired height, but the keepout can't be drawn correctly if the height is less than B measure, as some parts of the keepout will stay below the roof, so keepout 2 will be created with the minimum calculated height (B).
--></p>
<blockquote>
<p>Note that for flat roofs it is posible to create 0 height keepouts, but for inclinated roofs you need to use the invisible keepouts feature to allow keepouts at roof surface level.</p>
</blockquote>
<h2 id="invisible-keepouts">Invisible keepouts</h2>
<p>If you want to simulate a skylight or any keepout object without drawing the 3d volume you can check the Invisible keepout option to hide the 3D volume but still taking the obstacle into account.</p>
<p><img class="w400px" src="./layout-doc-imgs/imgs-sin-monitor/invisible-keepout-toggle.jpg" alt="invisible-keepout-toggle" /></p>
<h2 id="crop-keepout-to-the-building-shape">Crop keepout to the building shape</h2>
<p>When editing the vertices of a keepout you can check the ‘crop to building limits’. This helps you to draw keepouts that extends to the border of the building with more precision.</p>
<p><img class="w400px" src="./layout-doc-imgs/imgs-sin-monitor/crop-shape-building-toggle.jpg" alt="crop-shape-building-toggle" /></p>
<p>If you uncheck this option then the keepout can be floating outside the building limits. At least one vertex of the keepout should be inside the building limits to be created.</p>
<div class="page-break"></div>
<h1 id="subareas">Subareas</h1>
<h2 id="subarea-creation">Subarea creation</h2>
<p>A subarea is a region inside an area that allows you to define a modules installation just in a section of the area.</p>
<p>To create a subarea click on the ‘Create subarea’ button.</p>
<p><img class="w200px" src="./layout-doc-imgs/new-img/subarea-creation-button.png" alt="subarea-creation-button" /></p>
<p>Once the subarea is created, you will be able to:</p>
<ul>
<li>Edit</li>
<li>Move</li>
<li>Refresh (only if the area has one subarea)</li>
<li>Remove (only if the area has more than one subarea)</li>
<li>Clone</li>
</ul>
<p><img class="w200px" src="./layout-doc-imgs/new-img/remove-add-subareas.png" alt="remove-add-subareas" /></p>
<div class="page-break"></div>
<h2 id="add-subarea">Add subarea</h2>
<p>By clicking the ‘Create subarea’ button you enter in the subarea creation process.</p>
<p><img class="w75" src="./layout-doc-imgs/new-img/add-subarea.png" alt="add-subarea" /></p>
<h3 id="crop-subarea-to-the-area-shape">Crop subarea to the area shape</h3>
<p>When editing the vertices of a subarea you can check the ‘Crop’. This helps you to draw keepouts that extends to the border of the building with more precision.</p>
<p><img class="w200px" src="./layout-doc-imgs/new-img/crop-shape-building-toggle.png" alt="crop-shape-building-toggle" /></p>
<p>If you uncheck this option then the subarea can extend outside the area, following the area plane.</p>
<p><img class="w75" src="./layout-doc-imgs/new-img/subarea-sample.png" alt="subarea-sample" /></p>
<h3 id="edit-subarea-vertices">Edit subarea vertices</h3>
<p>By clicking this button you can modify subarea vertices and the subarea will be recalculated.</p>
<h3 id="remove-subarea">Remove subarea</h3>
<p>By clicking this button you can remove a single subarea from the subareas list.</p>
<div class="page-break"></div>
<h1 id="layout-coordinate-systems">Layout Coordinate Systems</h1>
<p>The 3DLayout works in four different coordinate systems, depending on which context we are requesting info.</p>
<h2 id="world-coordinate-system">World Coordinate System</h2>
<p><img class="w75" src="./layout-doc-imgs/imgs-sin-monitor/world-coords.png" alt="world-coords" /></p>
<p>World coordinate system works with spherical coordinates, latitude and longitude.</p>
<p>The values stored in this system and the API calls to retrieve this data are:</p>
<ul>
<li>Layout project center &gt; getLayout</li>
</ul>
<div class="page-break"></div>
<h2 id="scene-coordinate-system">Scene Coordinate System</h2>
<p><img class="w75" src="./layout-doc-imgs/imgs-sin-monitor/scene-coords.png" alt="scene-coords" /></p>
<p>Scene coordinate system works with cartesian coords, with origin in the layout project center and distances measured in meters. It is used to place each building relative to the project center.</p>
<p>The values stored in this system and the API calls to retrieve this data are:</p>
<ul>
<li>Building data center &gt; getBuildingInfo()</li>
</ul>
<div class="page-break"></div>
<h2 id="building-coordinate-system">Building Coordinate System</h2>
<p><img class="w75" src="./layout-doc-imgs/imgs-sin-monitor/building-coords.png" alt="building-coords" /></p>
<p>Building coordinate System works with cartesian coords, with origin in the building center and measured in meters. Al tilted surfaces are represented in ortographic view.</p>
<p>The values stored in this system and the API calls to retrieve this data are:</p>
<ul>
<li>Building vertices (verticesMCoords) &gt; getBuildingInfo()</li>
</ul>
<div class="page-break"></div>
<h2 id="area-coordinate-system">Area Coordinate System</h2>
<p><img class="w75" src="./layout-doc-imgs/imgs-sin-monitor/area-coords.png" alt="area-coords" /></p>
<p>Area Coordinate System works in cartesian coords, with origin in the bottom-left corner of the area, and rotated with the exterior wall azimuth of the area. On flat roofs the first wall drawed is considered the main wall.</p>
<p>The values stored in this system and the API calls to retrieve this data are:</p>
<ul>
<li>Area vertices (verticesMCoords) &gt; getAreaInfo()</li>
<li>Area offset vertices (verticesOffsetMCoords) &gt; getAreaInfo()</li>
<li>Area modules coords (modulesData (x/y)) &gt; getAreaInfo()</li>
</ul>
<p>This is the same for subareas, just using <strong>getSubareaInfo</strong></p>
<h1 id="how-to-use">How to use</h1>
<h2 id="api-key-and-autentication">Api key and autentication</h2>
<p>To start using the 3DLayout in your platform, you need to add the following script:</p>
<pre><code>&lt;script data-key=&quot;API_KEY_HERE&quot; src=&quot;https://layout.ezzing.com/lib.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>where you would replace <code>API_KEY_HERE</code> by an API key we provide you for your account.</p>
<h2 id="dom-element">DOM element</h2>
<p>You need an element in the body of your html page, a div where <strong>the 3DLayout will fit inside this element</strong>.</p>
<blockquote>
<p>This div can’t be bigger than the view size, and <strong>no scroll</strong> has to be applied to the html page.</p>
</blockquote>
<p>You should not change the ezzing3d element size (width or height) but change the size of this container div.</p>
<pre><code>&lt;div style=&#39;height:100vh; width: 100vw&#39;&gt;
    &lt;ezzing3d id=&#39;ezzing3d&#39;&gt;&lt;/ezzing3d&gt;
&lt;/div&gt;</code></pre>
<h2 id="basic-functions">Basic functions</h2>
<p>Adding the <code>client.min.js</code> script with a valid API Key makes available the <code>Ezzing3DApi</code> global object, which we will use to start using the 3DLayout.</p>
<p>The Ezzing3DApi object has the following functions:</p>
<ul>
<li>createLayout</li>
<li>getLayout</li>
<li>listLayouts</li>
<li>loadLayout</li>
<li>destroyLayout</li>
</ul>
<h3 id="createlayout">createLayout</h3>
<p>Create a new layout with the specified information.</p>
<pre><code>var data = {
    title: &quot;EzzingSolar&quot;,
    latitude: 40.428121,
    longitude: -3.698695,
    address: &quot;Calle de Sagasta, 18&quot;,
    zip: &quot;28004&quot;,
    city: &quot;Madrid&quot;,
    province: &quot;Madrid&quot;,
    country: &quot;Spain&quot;
};</code></pre>
<p>Where all values are optional except latitude and longitude that are required.</p>
<pre><code>Ezzing3DApi.createLayout(data, function(err, layoutData) {
    if (err) throw err;
    console.log(layoutData);
});</code></pre>
<p>Which will return the information from the created layout:</p>
<pre><code>{
  id: 1093,
  title: &quot;EzzingSolar&quot;,
  address: &quot;Calle de Sagasta, 18&quot;,
  zip: &quot;28004&quot;,
  city: &quot;Madrid&quot;,
  province: &quot;Madrid&quot;,
  country: &quot;Spain&quot;,
  latitude: &quot;40.428121&quot;,
  longitude: &quot;-3.698695&quot;,
  created_at: &quot;2016-08-18T17:15:15+0000&quot;,
  updated_at: &quot;2016-08-19T10:14:34+0000&quot;,
  url: &quot;https://layout.ezzing.com/#/GXXlgzDk0rPsrdxWfDsE5Cdi9FwUrBPx7GfuxSf0::1093&quot;
}</code></pre>
<p>where:</p>
<ul>
<li><strong>id</strong>: the layout id, you need this id to load the project or retrieve information,</li>
<li><strong>title</strong>: A title for the project,</li>
<li><strong>address</strong>: the address</li>
<li><strong>city</strong>: the city,</li>
<li><strong>province</strong>: the province,</li>
<li><strong>country</strong>: the contry,</li>
<li><strong>zip</strong>: the zip code,</li>
<li><strong>latitude</strong>: latitude value in decimal degrees (remember to include the negative sign for south and west coordinates) ,</li>
<li><strong>longitude</strong>:longitude value in decimal degrees (remember to include the negative sign for south and west coordinates),</li>
<li><strong>created_at</strong>: creation date,</li>
<li><strong>updated_at</strong>: modification date,</li>
<li><strong>url</strong>: an url to visit the project or embed it as an iframe</li>
</ul>
<blockquote>
<p>The url can be used to embed a readonly version of the project. You can read a description of this methods in the <a href="#showcase-mode">Showcase mode</a> section.</p>
</blockquote>
<p>The data types in which each value is stored are:</p>
<ul>
<li><strong>id</strong>: integer</li>
<li><strong>title</strong>: string 255 chars</li>
<li><strong>address</strong>: string 255 chars</li>
<li><strong>city</strong>: string 255 chars</li>
<li><strong>province</strong>: string 255 chars</li>
<li><strong>country</strong>: string 255 chars</li>
<li><strong>zip</strong>: string 255 chars</li>
<li><strong>latitude</strong>: decimal (+/-)xx.yyyyyyyy (max. precision 8 decimal digits)</li>
<li><strong>longitude</strong>: decimal (+/-)xxx.yyyyyyyy (max. precision 8 decimal digits)</li>
<li><strong>created_at</strong>: ISO8601</li>
<li><strong>updated_at</strong>: ISO8601</li>
<li><strong>url</strong>: string 2000 chars</li>
</ul>
<h3 id="getlayout">getLayout</h3>
<p>Returns the information of a layout related to the given id</p>
<pre><code>Ezzing3DApi.getLayout(id, function(err, layoutData) {
    if (err) throw err;
    console.log(layoutData);
});</code></pre>
<h3 id="listlayouts">listLayouts</h3>
<p>Returns a list of all your created layouts.</p>
<pre><code>Ezzing3DApi.listLayouts(function(err, layoutData) {
    if (err) throw err;
    console.log(layoutData);
});</code></pre>
<h3 id="loadlayout">loadLayout</h3>
<p>Sets up the 3DLayout interface into the ezzing3D container and loads the project related to the given id.</p>
<pre><code>Ezzing3DApi.loadLayout(id, function(err, layout, container) {
    if (err) throw err;
});</code></pre>
<p>loadLayout can receive an <code>options</code> argument where you can setup some customizations.</p>
<blockquote>
<p>You can read a description of this methods in the <a href="#layout-rules">Layout Rules</a> section.</p>
</blockquote>
<pre><code>var rules = {};

Ezzing3DApi.loadLayout(id, rules, function(err, layout, container) {
    if (err) throw err;
});</code></pre>
<p>This method returns two objects, where:</p>
<ul>
<li>layout: Exposes an object with methods to interact with the 3DLayout.</li>
</ul>
<blockquote>
<p>You can read a description of this methods in the <a href="#dlayout-communication-system">3DLayout Communication System</a> section.</p>
</blockquote>
<ul>
<li>container: the DOM element where the 3DLayot is created.</li>
</ul>
<h2 id="showcase-mode">Showcase mode</h2>
<p>If you want to show the layout to a customer or embed it in read-only mode in another page of your platform (to act as a thumbnail of the project) you can do it by adding an iframe element to an html page, with a modified version of the url of the layout.</p>
<h3 id="showcase-without-camera-spin">Showcase without camera spin</h3>
<pre><code>&lt;iframe src=(url + &quot;/showcase&quot;)&gt; &lt;/iframe&gt;</code></pre>
<p>In this mode the 3DLayout will show the project in perspective mode without any gui elements and a quiet 3d view. You can click and drag with the mouse to rotate the view and zoom with the mouse wheel.</p>
<h3 id="showcase-with-camera-spin">Showcase with camera spin</h3>
<pre><code>&lt;iframe src=(url + &quot;/spin-showcase&quot;)&gt; &lt;/iframe&gt;</code></pre>
<p>In this mode the 3DLayout will show the project in perspective mode without any gui elements and a rotating 3d view. You can click and drag with the mouse to rotate the view and zoom with the mouse wheel. Once clicked the rotation will stop.</p>
<h1 id="dlayout-communication-system">3DLayout Communication System</h1>
<h2 id="info-events-sent-by-3dlayout">Info Events sent by 3DLayout</h2>
<p>The 3DLayout triggers different events to report actions when they are accomplished or to inform on GUI changes.</p>
<p>An example on how to listen this events:</p>
<pre><code>var container = window.document.getElementById(&#39;ezzing3d&#39;);

container.addEventListener(&quot;buildingSelected&quot;, function(event, data){
    console.log(event.detail);
});</code></pre>
<p>The full list of events emmited by the 3DLayout are:</p>
<!-- * load -->
<ul>
<li>zoomChanged</li>
<li>fullscreen</li>
<li>tabChanged</li>
<li>editArea</li>
<li>editKeepout</li>
<li>editTree</li>
<li>areaChanged</li>
<li>buildingChanged</li>
<li>roofChanged</li>
<li>editRoof</li>
<li>editVertices</li>
<li>buildingRemoved</li>
<li>buildingSelected</li>
<li>buildingCreated</li>
<li>customAlertOk</li>
</ul>
<!--  
### load

This event is triggered when the 3DLayout finish to load the project from the CRM
-->
<h3 id="zoomchanged">zoomChanged</h3>
<p>This event is triggered when the zoom is changed in the canvas. It sends the zoom level value.</p>
<h3 id="fullscreen">fullscreen</h3>
<p>This event is triggered when the user changes from normal view to fullscreen. It sends <strong>true</strong> when changing to fullscreen and <strong>false</strong> when disabling fullscreen mode.</p>
<h3 id="tabchanged">tabChanged</h3>
<p>This event is triggered every time the user changes the aside panel navigation tab. It sends a string with the current tab name, the values can be one of this: [ “building”, “areas”, “keepouts”, “trees” ].</p>
<h3 id="editarea">editArea</h3>
<p>This event is triggered every time the user enters the edit section of an area. The event sends the <strong>area.id</strong>.</p>
<h3 id="editkeepout">editKeepout</h3>
<p>This event is triggered every time the user enters the edit section of a keepout. The event sends the <strong>keepout.id</strong>.</p>
<h3 id="edittree">editTree</h3>
<p>This event is triggered every time the user enters the edit section of a tree. The event sends the <strong>tree.id</strong>.</p>
<h3 id="areachanged">areaChanged</h3>
<p>This event is triggerd every time an area attribute is changed. The event sends back an array with this info:</p>
<pre><code>[area.id, attribute, value]</code></pre>
<h3 id="buildingchanged">buildingChanged</h3>
<p>This event is triggered every time a building is changed. The event sends back an array with this info:</p>
<pre><code>[building.id, building attribute, value]</code></pre>
<h3 id="roofchanged">roofChanged</h3>
<p>This event is triggered every time a roof attribute is changed. The event sends back an array with this info:</p>
<pre><code>[building.id, roof attribute, value]</code></pre>
<h3 id="editroof">editRoof</h3>
<p>This event is triggered every time the user enters the roof edit section of a building. The event sends the <strong>building.id</strong></p>
<h3 id="editvertices">editVertices</h3>
<p>This event is triggered every time the user enters the vertices edit section of a building. The event sends the <strong>building.id</strong></p>
<h3 id="buildingremoved">buildingRemoved</h3>
<p>This event is triggered every time a building is deleted. The event sends the <strong>building.id</strong> (after this operation this building won’t longer exist in the project)</p>
<h3 id="buildingselected">buildingSelected</h3>
<p>This event is triggered every time a new building becomes active. The event sends the <strong>building.id</strong></p>
<h3 id="buildingcreated">buildingCreated</h3>
<p>This event is triggered every time a new building is created. The event sends the <strong>building.id</strong></p>
<!-- ### customAlertOk

This event is triggered when the user confirm a custom alert dialog.

> You can read a description of this methods in the [Layout Rules](#layout-rules) section. -->
<h2 id="functions-to-retrieve-info-from-3dlayout">Functions to retrieve info from 3DLayout</h2>
<p>There is a set of functions to retrieve information from the 3DLayout.</p>
<p>For all these functions you can pass a callback as an argument to be executed when data is retrieved.</p>
<h3 id="generic-functions">Generic Functions</h3>
<p>Set of generic functions to retrieve project information from the layout. You just need to pass the <strong>callback</strong>, no other arguments are needed.</p>
<ul>
<li>getCurrentBuildingId</li>
<li>getLayoutData</li>
<li>getNumberOfModules</li>
<li>getTotalPower</li>
<li>getPower</li>
</ul>
<h4 id="getcurrentbuildingid">getCurrentBuildingId</h4>
<pre><code>layout.getCurrentBuildingId(callback);</code></pre>
<p>This function returns the id value of the current active building.</p>
<h4 id="getlayoutdata">getLayoutData</h4>
<pre><code>layout.getLayoutData(callback);</code></pre>
<p>This function returns a JSON with an array of buildings.</p>
<p>Each building in the array contains:</p>
<pre><code>{
    id: the building id,
    name: the building name,
    areas: an array of areas in the building
}</code></pre>
<p>Each area in the areas array contains:</p>
<pre><code>{
    id: the area id,
    name: the area name,
    subareas: an array of subareas in the area
}</code></pre>
<p>Each subarea in the subareas array contains:</p>
<pre><code>{
    id: the subarea id,
    name: the subarea name
}</code></pre>
<h4 id="getnumberofmodules">getNumberOfModules</h4>
<pre><code>layout.getNumberOfModules(callback);</code></pre>
<p>This function returns a JSON with an array of buildings.</p>
<p>Each building in the array contains:</p>
<pre><code>{
    id: the building id,
    name: the building name,
    modules: total of modules in the building
    areas: an array of areas in the building
}</code></pre>
<p>Each area in the areas array contains:</p>
<pre><code>{
    id: the area id,
    name: the area name,
    modules: total of modules in the area,
    subareas: an array of subareas in the area
}</code></pre>
<p>Each subarea in the subareas array contains:</p>
<pre><code>{
    id: the subarea id,
    name: the subarea name,
    modules: total of modules in the subarea
}</code></pre>
<h4 id="gettotalpower">getTotalPower</h4>
<pre><code>layout.getTotalPower(callback);</code></pre>
<p>Returns the total power for all the buildings in the project.</p>
<h4 id="getpower">getPower</h4>
<pre><code>layout.getPower(callback);</code></pre>
<p>Returns an array of all buildings in the project.</p>
<p>Each building in the array contains:</p>
<pre><code>{
    id: the building id,
    name: the building name,
    power: the total power for this building,
    areas: array of areas in this building
}</code></pre>
<p>Each area in the areas array contains:</p>
<pre><code>{
    id: the area id,
    name: the area name,
    power: total power in this area,
    subareas: an array of subareas in the area
}</code></pre>
<p>Each subarea in the subareas array contains:</p>
<pre><code>{
    id: the subarea id,
    name: the subarea name,
    power: total power in this subarea
}</code></pre>
<h3 id="building-related-functions">Building related functions</h3>
<p>Set of generic functions to retrieve building related information from the layout. In this set of functions you should pass an existing building id and a callback.</p>
<ul>
<li>getBuildingInfo</li>
<li>getRoofInfo</li>
<li>getBuildingPosition</li>
</ul>
<h4 id="getbuildinginfo">getBuildingInfo</h4>
<pre><code>layout.getBuildingInfo(id, callback);</code></pre>
<p>Returns building information for a given building.id</p>
<p>The data returned is:</p>
<pre><code>{
    id: the building id,
    name: the building name,
    height: building height (in meters),
    regular: true if building angles are all equal to 90º, false otherwise.
    buildingArea: building area measure (in square meters),
    centerDeg: building center in World coordinate system,
    centerMCoords: building center in Scene coordinate system,
    vertices: building vertices in world coordinate system  [DEPRECATED],
    verticesMCoords: building vertices in building coordinate system,
    modules: total of modules in the building
    power: total power of the building,
    areas: array of areas in this building
}</code></pre>
<p>Each area in the areas array contains:</p>
<pre><code>{
    id: the area id,
    name: the area name,
    subareas: an array of subareas in the area
}</code></pre>
<p>Each subarea in the subareas array contains:</p>
<pre><code>{
    id: the subarea id,
    name: the subarea name
}</code></pre>
<h4 id="getroofinfo">getRoofInfo</h4>
<pre><code>layout.getRoofInfo(id, callback);</code></pre>
<p>Returns roof information for a given building.id]</p>
<p>The data returned is:</p>
<pre><code>{
    height: roof height (in meters, not including building height),
    inclination: roof angle (in degrees),
    material: roof material (i.e: tiled/corugated),
    orientation: roof orientation (i.e: east/west or nort/south),
    type: roof type (i.e: flat, pent, gabled, etc...)
}</code></pre>
<h4 id="getbuildingposition">getBuildingPosition</h4>
<pre><code>layout.getBuildingPosition(id, callback);</code></pre>
<p>Returns building position info for a given building.id.</p>
<p>The data returned is:</p>
<pre><code>{
    center: building center in world coord system [DEPRECATED],
    vertices: array of building vertices, world coord system [DEPRECATED],
    centerDeg: building center in World coord system,
    centerMCoords: building center in Scene coord system,
    verticesMCoords: building vertices in building coord system,
}</code></pre>
<h3 id="area-related-functions">Area related functions</h3>
<p>Set of generic functions to retrieve Area related information from the layout. In this set of functions you should pass an existing area id and a callback.</p>
<ul>
<li>getAreaInfo</li>
<li>getModuleInfoByArea</li>
<li>getModulesStructureByArea</li>
<li>getAreaOffset</li>
</ul>
<h4 id="getareainfo">getAreaInfo</h4>
<pre><code>layout.getAreaInfo(id, callback);</code></pre>
<p>Returns area info for a given area.id.</p>
<p>The data returned is:</p>
<pre><code>{
    id: the area id,
    name: the area name,
    offset: the area offset,
    placement: placement (i.e: portrait / landscape),
    structure: i.e: east-west / standard,
    inclination: modules inclination (in degrees),
    azimuth: modules azimuthal inclination (in degrees),
    areaMCoords: array with area vertices coordinates in Area system coords [DEPRECATED],
    areaOffsetMCoords: array with offseted area vertices in Area system coords [DEPRECATED],
    verticesMCoords: array with area vertices coordinates in Area system coords,
    verticesOffsetMCoords: array with offseted area vertices in Area system coords,
    wallSizes: size in meters for each area wall,
    wallAzimuth: azimuthal angle for the external area wall,
    power: total power of the area,
    subareas: an array of subareas in the area
}</code></pre>
<p>Each subarea in the subareas array contains:</p>
<pre><code>{
    id: the subarea id,
    name: the subarea name
}</code></pre>
<h4 id="getmoduleinfobyarea">getModuleInfoByArea</h4>
<pre><code>layout.getModuleInfoByArea(id, callback);</code></pre>
<p>Returns module info for a given area.id.</p>
<p>The data returned is:</p>
<pre><code>{
    id: the module id,
    name: the module model name,
    reference: extra model information,
    width: the width of the module (in meters),
    height: the height of the module (in meters),
    length: the lenght of the module (in meters),
    power: the power of the module
}</code></pre>
<h4 id="getmodulesstructurebyarea">getModulesStructureByArea</h4>
<pre><code>layout.getModulesStructureByArea(id, callback);</code></pre>
<p>Returns a JSON with an array of modules for a given area.id.</p>
<p>The data for each module in the array is:</p>
<pre><code>{
    x: x position of the module in Area system coords,
    y: y position of the module in Area system coords,
    col: column to which the module belongs,
    row: row to which the module belongs,,
    rX: rotation of the module in the X axis (inclination),
    rZ: rotation of the module in the Z axis (azimuth),
    color: the color of the module (only exist if color is not default),
}</code></pre>
<h4 id="getareaoffset">getAreaOffset</h4>
<pre><code>layout.getAreaOffset(id, offset, callback);</code></pre>
<p>Returns an array of vertices containing the offseted area for a given area.id and offset.</p>
<p>If the offset is a negative value, then the area is reduced by the offset value (in meters).</p>
<h3 id="subarea-related-functions">Subarea related functions</h3>
<p>Set of generic functions to retrieve Area related information from the layout. In this set of functions you should pass an existing area id and a callback.</p>
<ul>
<li>getSubareaInfo</li>
<li>getModuleInfoBySubarea</li>
<li>getModulesStructureBySubarea</li>
</ul>
<h4 id="getsubareainfo">getSubareaInfo</h4>
<pre><code>layout.getSubareaInfo(id, callback);</code></pre>
<p>Returns subarea info for a given subarea.id.</p>
<p>The data returned is:</p>
<pre><code>{
    id: the subarea id,
    name: the subarea name,
    offset: the subarea offset,
    placement: placement (i.e: portrait / landscape),
    structure: i.e: east-west / standard,
    inclination: modules inclination (in degrees),
    azimuth: modules azimuthal inclination (in degrees),
    verticesMCoords: array with subarea vertices coordinates in Area system coords,
    verticesOffsetMCoords: array with offseted subarea vertices in Area system coords,
    wallSizes: size in meters for each subarea wall,
    wallAzimuth: azimuthal angle for the external area wall,
    power: total power of the subarea,
}</code></pre>
<h4 id="getmoduleinfobysubarea">getModuleInfoBySubarea</h4>
<pre><code>layout.getModuleInfoBySubarea(id, callback);</code></pre>
<p>Returns module info for a given subarea.id.</p>
<p>The data returned is:</p>
<pre><code>{
    id: the module id,
    name: the module model name,
    reference: extra model information,
    width: the width of the module (in meters),
    height: the height of the module (in meters),
    length: the lenght of the module (in meters),
    power: the power of the module
}</code></pre>
<h4 id="getmodulesstructurebysubarea">getModulesStructureBySubarea</h4>
<pre><code>layout.getModulesStructureBySubarea(id, callback);</code></pre>
<p>Returns a JSON with an array of modules for a given subarea.id.</p>
<p>The data for each module in the array is:</p>
<pre><code>{
    x: x position of the module in Area system coords,
    y: y position of the module in Area system coords,
    col: column to which the module belongs,
    row: row to which the module belongs,,
    rX: rotation of the module in the X axis (inclination),
    rZ: rotation of the module in the Z axis (azimuth),
    color: the color of the module (only exist if color is not default),
}</code></pre>
<h2 id="functions-to-send-info-to-the-3dlayout">Functions to send info to the 3DLayout</h2>
<h3 id="customalert-event">CustomAlert event</h3>
<p>You can send this event to show an alert with some information to the user at any time.</p>
<pre><code>layout.customAlert(title_text_string, body_text_string, callback);</code></pre>
<!--
## Functions to set values in to the project

Set of functions to change values inside the project. There are two types:

* setAreaAttribute
* setBuildingAttribute

### setAreaAttribute

With this function you can change this area attributes:

* model
* placement
* structure
* inclination
* useShadowsCalculation
* inset.x
* inset.y
* totalInset.x
* totalInset.y
* offset
* azimuth

    var id = "aaa060bf-cae0-41b0-9fd2-c234262ea710";
    var field = "structure";
    var value = "Standard";

    scope.$emit("setAreaAttribute", [id, field, value]);
    scope.$emit("setAreaAttribute", [id, 'inclination', 45]);
    scope.$emit("setAreaAttribute", [id, 'inset.y', 0.0034]);
    scope.$emit("setAreaAttribute", [id, 'azimuth', 45]);

### setBuildingAttribute

With this function you can change this building fields

* name
* height
* roof.inclination
* roof.material


    var id = "64a1f446-a552-4aef-bed3-5268b62610a6";

    var value = 75;
    var field = "roof.inclination";
    scope.$emit("setBuildingAttribute", [id, field, value]);

    var value = 20;
    var field = "height";
    scope.$emit("setBuildingAttribute", [id, field, value]);
 -->
<h1 id="layout-rules">Layout Rules</h1>
<p>The user can customize many options in the 3DLayout. By passing a ‘rules’ attribute to the 3DLayout instance with a collection of objects, you can define the default values, add special behaviours to the 3DLayout and customize the interface.</p>
<p>Example of rules object:</p>
<pre><code>var rules = {
    &#39;display&#39;: true,
    &#39;zoom&#39;: 21,
    &#39;logo&#39;: false,
    &#39;CustomPalette&#39;: [&#39;#ff0000&#39;, &#39;#00ff00&#39;]
}</code></pre>
<p>Available rule objects expected by the 3DLayout:</p>
<ul>
<li>Special
<ul>
<li>perspective</li>
<li>spin</li>
<li>readonly</li>
<li>showcase</li>
<li>zoom</li>
<li>logo</li>
<li>azimuthOffset</li>
</ul></li>
<li>Default Values
<ul>
<li>modules</li>
<li>DefaultRoofs</li>
<li>DefaultBuilding</li>
<li>CustomPalette</li>
<li>maxBuildingHeight</li>
</ul></li>
<li>Custom Buttons
<ul>
<li>MainoptionsCustomButtons</li>
<li>ControlCustomButtons</li>
<li>AsideCustomButtons</li>
</ul></li>
</ul>
<h2 id="special-behaviours">Special Behaviours</h2>
<h3 id="perspective">Perspective</h3>
<p>When this options is set to true, the project starts in perspective mode.</p>
<pre><code>{&#39;perspective&#39;: true}</code></pre>
<h3 id="spin">Spin</h3>
<p>It only works in combination with perspective option. When this options is set to true, the project starts in perspective mode and the camera slowly rotate around.</p>
<pre><code>{&#39;spin&#39;: true}</code></pre>
<h3 id="read-only">Read only</h3>
<p>It only works in combination with perspective option. When this options is set to true, the project starts in perspective mode and all the GUI is hidden, avoiding the user to change anything in the layout.</p>
<pre><code>{&#39;readonly&#39;: true}</code></pre>
<h3 id="showcase">Showcase</h3>
<p>When this option is set to true, the project starts in perspective and write-only mode. This is an special feature to showcase the layout.</p>
<pre><code>{&#39;showcase&#39;: true}</code></pre>
<h3 id="zoom">zoom</h3>
<p>You can set the starting zoom value. Zoom values use to range between 17 (far) to 24 (near).</p>
<pre><code>{&#39;zoom&#39;: 21}</code></pre>
<h3 id="logo">logo</h3>
<p>You can choose to show (true) or hide (false) the ezzingsolar logo from the top part of the aside panel.</p>
<pre><code>{&#39;logo&#39;: true}</code></pre>
<h3 id="azimuthoffset">azimuthOffset</h3>
<p>Add an offset value to define your prefered convention for south faced modules.</p>
<p>Set azimuthOffset to 180 to have modules oriented to south with azimuth value of 180.</p>
<p>Set azimuthOffset to 0 or skip this value to have modules oriented to south with azimuth value of 0.</p>
<pre><code>{&#39;azimuthOffset&#39;: 180}</code></pre>
<h2 id="default-values">Default Values</h2>
<p>User can define the default values for modules, buildings, roofs and even the color palete for modules.</p>
<h3 id="modules">modules</h3>
<p>User can define the solar modules available in the 3DLayout.</p>
<p>Sample values to define modules:</p>
<pre><code>{
    &quot;modules&quot;: [
        {
            &quot;id&quot;: 4410,
            &quot;name&quot;: &quot;Canadian Solar&quot;,
            &quot;reference&quot;: &quot;250Wp Polykristallijn&quot;,
            &quot;power&quot;: 250,
            &quot;length&quot;: 1.638,
            &quot;width&quot;: 0.982,
            &quot;height&quot;: 0.04
        }, {
            &quot;id&quot;: 41403,
            &quot;name&quot;: &quot;Canadian Solar&quot;,
            &quot;reference&quot;: &quot;260WP All Black&quot;,
            &quot;power&quot;: 260,
            &quot;length&quot;: 1.638,
            &quot;width&quot;: 0.982,
            &quot;height&quot;: 0.04
        }
    ]
}</code></pre>
<p>The attributes for each module are:</p>
<pre><code>{
    id: a reference number (should be unique for each model)
    name: brand and model of the module
    reference: the reference of the model
    power: power generated by the module (in watts peak)
    lenght: lenght of the module (in meters)
    width: width of the module (in meters)
    height: height of the module (in meters)
}</code></pre>
<p>Note: the <strong>id</strong> value should be different for each module in the list.</p>
<h3 id="defaultroofs">DefaultRoofs</h3>
<p>User can define the default values for each roof type.</p>
<p>The 3DLayout currently has five available roof types: <strong>flat</strong>, <strong>pent</strong>, <strong>gabled</strong>, <strong>hipped</strong> and <strong>pyramid</strong>.</p>
<blockquote>
<p>Only roof types described in this objects are available to the user.</p>
</blockquote>
<p>Sample values to define Default Roofs:</p>
<pre><code>{
    &quot;DefaultRoofs&quot;: {
        &#39;gabled&#39;: {
            //roof related
            &quot;roofMaterial&quot;: &quot;tiled&quot;,
            &quot;availableRoofMaterial&quot;: [&quot;tiled&quot;, &quot;corrugated&quot;],
            &quot;orientation&quot;: &quot;EW&quot;,
            &quot;availableorientation&quot;: [&quot;EW&quot;, &quot;SN&quot;],
            &quot;roofInclination&quot;: 30,
            //area related
            &quot;moduleId&quot;: 47113,
            &quot;structure&quot;: &quot;Standard&quot;,
            &quot;availableStructures&quot;: [&quot;Standard&quot;, &quot;EW&quot;],
            &quot;offset&quot;: 0.4,
            &quot;inset&quot;: {
                &quot;x&quot;: 0.02,
                &quot;y&quot;: 0.02
            },
            &quot;azimuth&quot;: &quot;&quot;,
            &quot;moduleInclination&quot;: 0,
            &quot;moduleType&quot;: &quot;portrait&quot;,
            &quot;availableModuleType&quot;: [&quot;portrait&quot;, &quot;landscape&quot;],
            &quot;locked&quot;: [],
            &quot;hidden&quot;: []
        },
        &#39;hipped&#39;: {
            //roof related
            &quot;roofMaterial&quot;: &quot;tiled&quot;,
            &quot;availableRoofMaterial&quot;: [&quot;tiled&quot;, &quot;corrugated&quot;],
            &quot;orientation&quot;: &quot;EW&quot;,
            &quot;availableorientation&quot;: [&quot;EW&quot;, &quot;SN&quot;],
            &quot;roofInclination&quot;: 30,
            //area related
            &quot;moduleId&quot;: 47113,
            &quot;structure&quot;: &quot;Standard&quot;,
            &quot;availableStructures&quot;: [&quot;Standard&quot;, &quot;EW&quot;],
            &quot;offset&quot;: 0.4,
            &quot;inset&quot;: {
                &quot;x&quot;: 0.02,
                &quot;y&quot;: 0.02
            },
            &quot;azimuth&quot;: &quot;&quot;,
            &quot;moduleInclination&quot;: 0,
            &quot;moduleType&quot;: &quot;portrait&quot;,
            &quot;availableModuleType&quot;: [&quot;portrait&quot;, &quot;landscape&quot;],
            &quot;locked&quot;: [],
            &quot;hidden&quot;: []
        },
        &#39;pyramid&#39;: {
            //roof related
            &quot;roofMaterial&quot;: &quot;tiled&quot;,
            &quot;availableRoofMaterial&quot;: [&quot;tiled&quot;, &quot;corrugated&quot;],
            &quot;orientation&quot;: &quot;&quot;,
            &quot;availableorientation&quot;: [],
            &quot;roofInclination&quot;: 30,
            //area related
            &quot;moduleId&quot;: 47113,
            &quot;structure&quot;: &quot;Standard&quot;,
            &quot;availableStructures&quot;: [&quot;Standard&quot;, &quot;EW&quot;],
            &quot;offset&quot;: 0.4,
            &quot;inset&quot;: {
                &quot;x&quot;: 0.02,
                &quot;y&quot;: 0.02
            },
            &quot;azimuth&quot;: &quot;&quot;,
            &quot;moduleInclination&quot;: 0,
            &quot;moduleType&quot;: &quot;portrait&quot;,
            &quot;availableModuleType&quot;: [&quot;portrait&quot;, &quot;landscape&quot;],
            &quot;locked&quot;: [],
            &quot;hidden&quot;: []
        },
        &#39;pent&#39;: {
            //roof related
            &quot;roofMaterial&quot;: &quot;tiled&quot;,
            &quot;availableRoofMaterial&quot;: [&quot;tiled&quot;, &quot;corrugated&quot;],
            &quot;orientation&quot;: &quot;S&quot;,
            &quot;availableorientation&quot;: [&quot;E&quot;, &quot;W&quot;, &quot;N&quot;, &quot;S&quot;],
            &quot;roofInclination&quot;: 30,
            //area related
            &quot;moduleId&quot;: 47113,
            &quot;structure&quot;: &quot;Standard&quot;,
            &quot;availableStructures&quot;: [&quot;Standard&quot;, &quot;EW&quot;],
            &quot;offset&quot;: 0.4,
            &quot;inset&quot;: {
                &quot;x&quot;: 0.02,
                &quot;y&quot;: 0.02
            },
            &quot;azimuth&quot;: &quot;&quot;,
            &quot;moduleInclination&quot;: 0,
            &quot;moduleType&quot;: &quot;portrait&quot;,
            &quot;availableModuleType&quot;: [&quot;portrait&quot;, &quot;landscape&quot;],
            &quot;locked&quot;: [],
            &quot;hidden&quot;: []
        },
        &#39;flat&#39;: {
            //roof related
            &quot;roofMaterial&quot;: &quot;Bitum&quot;,
            &quot;availableRoofMaterial&quot;: [&quot;Bitum&quot;, &quot;Concrete&quot;, &quot;EPDM&quot;, &quot;PVC&quot;],
            &quot;orientation&quot;: &quot;&quot;,
            &quot;availableorientation&quot;: [],
            &quot;roofInclination&quot;: 0,
            //area related
            &quot;moduleId&quot;: 47113,
            &quot;structure&quot;: &quot;EW&quot;,
            &quot;availableStructures&quot;: [&quot;EW&quot;, &quot;Standard&quot;],
            &quot;offset&quot;: 1,
            &quot;inset&quot;: {
                &quot;x&quot;: 0.02,
                &quot;y&quot;: 0.01
            },
            &quot;azimuth&quot;: &quot;&quot;,
            &quot;moduleInclination&quot;: 10,
            &quot;availableModuleInclination&quot;: [10, 15, 20],
            &quot;moduleType&quot;: &quot;landscape&quot;,
            &quot;availableModuleType&quot;: [&quot;portrait&quot;, &quot;landscape&quot;],
            &quot;locked&quot;: [],
            &quot;hidden&quot;: []
        }
    }
}</code></pre>
<p>Attributes explanation for default roof description:</p>
<pre><code>{
    //roof related
    &quot;roofMaterial&quot;: should be one from the availableRoofMaterial list,
    &quot;availableRoofMaterial&quot;: array of strings with the roof material names,
    &quot;orientation&quot;: should be one from the availableorientation list, it can be an empty string for flat types,
    &quot;availableorientation&quot;: array of strings with the orientation names. [&#39;EW&#39;, &#39;SN&#39;] or [&quot;E&quot;, &quot;W&quot;, &quot;N&quot;, &quot;S&quot;]
    &quot;roofInclination&quot;: angle for the roof (in degrees),
    //area related
    &quot;moduleId&quot;: it is the default module model id, it is an optional attribute, if it doesn&#39;t exist the first model in the module list will be used,
    &quot;structure&quot;: should be one from the availableStructures list,
    &quot;availableStructures&quot;: array of strings with the structure names [&quot;EW&quot;, &quot;Standard&quot;],
    &quot;offset&quot;: the distance to avoid from area borders (in meters),
    &quot;inset&quot;: {
        &quot;x&quot;: the distance between module borders in the x axis (in meters) ,
        &quot;y&quot;:  the distance between module borders in the x axis (in meters)
    },
    &quot;azimuth&quot;: angle between the module and the north pole, it can be set as an empty string to let the 3DLayout to calculate the angle according to the external wall of the area,
    &quot;moduleInclination&quot;: default module inclination. if availableModuleInclination is an array, this value should match one of the options in the array,
    &quot;availableModuleInclination&quot;: this value can be an array of integers to restrict the inclination to this values. It can also be defined as an empty string to ignore the restriction,
    &quot;moduleType&quot;: should be one from the availableModuleType list,
    &quot;availableModuleType&quot;: array of strings with the available module types (i.e [&quot;landscape&quot;, &quot;portrait&quot;])
    &quot;locked&quot;: array of strings with the area attributes that should be locked,
    &quot;hidden&quot;: array of strings with the area attributes that should be hidden
}</code></pre>
<h3 id="defaultbuilding">DefaultBuilding</h3>
<p>User can define the default building. These are the default values for each new created building.</p>
<p>Sample values to define default building:</p>
<pre><code>{
    &quot;DefaultBuilding&quot;: {
        data: {
            height: 10,
            roof: {
                type: &#39;gabled&#39;,
                inclination: 30,
                orientation: &#39;EW&#39;,
                material: &#39;tiled&#39;
            },
            vertices: [],
            areas: [],
            keepouts: []
        }
    }
}</code></pre>
<p>The attributes for the default building:</p>
<pre><code>{
    data: {
        height: default height of the building (in meters),
        roof: {
            type: roof type (one of the available types in the defaultRoofs object),
            inclination: angle for the roof (in degrees),
            orientation: orientation of the roof ridge (&#39;EW&#39; for east-west or &#39;NS&#39; for  north-south orientation),
            material: material of the roof (one of the available materials in the defaultRoofs object),
        },
        vertices: []
        areas: [],
        keepouts: []
    }
}</code></pre>
<h3 id="custompalette">CustomPalette</h3>
<p>User can define a custom set of hexadecimal colors. These colors are used to define module colors.</p>
<p>To define your own color palette use this squeme:</p>
<pre><code>{
    &quot;CustomPalette&quot;: [
        &#39;#242345&#39;,
        &#39;#000000&#39;,
        &#39;#ff0000&#39;
    ]
}</code></pre>
<h3 id="maxbuildingheight">maxBuildingHeight</h3>
<p>User can limit the maximum height of buildings in the layout by defining this value.</p>
<pre><code>{
    &quot;maxBuildingHeight&quot;: 25    (value in meters)
}</code></pre>
<h2 id="custom-buttons">Custom Buttons</h2>
<p>There are several areas in the 3DLayout where the user can add his own functions. This areas are the <strong>main options buttons</strong> and the <strong>control buttons</strong>. Each one are defined in a JSON description that can be added to the layoutRules object.</p>
<p>When the user adds a new button, this is defined as a event emitter.<br />
We use the fontawesome icons collection, so you can use it to define new buttons.</p>
<h3 id="mainoptionscustombuttons">MainoptionsCustomButtons</h3>
<p><img class="w100" src="./layout-doc-imgs/new-img/mainoptions.png" alt="mainoptions" /></p>
<p>The buttons on top of the canvas are custom buttons. User can define new custom buttons in this area.</p>
<p>Here you can hide some existing buttons, change the order of them and create new ones with the ability to trigger an event.</p>
<p>This is the default MainoptionsCustomButtons:</p>
<pre><code>{
    &quot;MainoptionsCustomButtons&quot;: [
        {
            click: &#39;undo.undo()&#39;,
            tooltip: &#39;undo&#39;,
            class: &#39;fa fa-fw fa-undo&#39;,
            location: &#39;left&#39;
        },
        {
            click: &#39;undo.redo()&#39;,
            tooltip: &#39;redo&#39;,
            class: &#39;fa fa-fw fa-repeat&#39;,
            location: &#39;left&#39;
        },
        {
            click: &#39;save(true)&#39;,
            tooltip: &#39;save&#39;,
            ngclass: &#39;saveButtonClass()&#39;,
            location: &#39;left&#39;
        },
        {
            click: &quot;snapshot()&quot;,
            tooltip: &quot;takeSnapshot&quot;,
            class: &quot;fa fa-fw fa-camera-retro&quot;
        }, {
            click: &quot;widgets.simulation.toggle()&quot;,
            tooltip: &quot;sunSimulation&quot;,
            class: &quot;fa fa-fw fa-sun-o&quot;
        }, {
            click: &quot;setCamera(&#39;orthographic&#39;)&quot;,
            hide: &quot;display.camera.name === &#39;orthographic&#39;&quot;,
            tooltip: &quot;switchTo2D&quot;,
            class: &quot;fa fa-fw fa-square-o&quot;
        }, {
            click: &quot;setCamera(&#39;perspective&#39;)&quot;,
            hide: &quot;display.camera.name === &#39;perspective&#39;&quot;,
            tooltip: &quot;switchTo3D&quot;,
            class: &quot;fa fa-fw fa-cube&quot;
        },{
            click: &quot;setScreen(&#39;full&#39;)&quot;,
            hide: &quot;fullScreen&quot;,
            tooltip: &quot;switch to full screen&quot;,
            class: &quot;fa fa-fw fa-arrows-alt&quot;
        }, {
            click: &quot;setScreen(&#39;normal&#39;)&quot;,
            hide: &quot;!fullScreen&quot;,
            tooltip: &quot;cancel full screen&quot;,
            class: &quot;fa fa-fw fa-desktop&quot;
        }, {
            click: &quot;setProvider(0)&quot;,
            hide: &quot;map.provider === 0 || map.provider === 1&quot;,
            tooltip: &quot;cyclomedia&quot;,
            class: &quot;fa fa-fw fa-map&quot;
        }, {
            click: &quot;setProvider(1)&quot;,
            hide: &quot;map.provider === 1 || map.provider === 2&quot;,
            tooltip: &quot;grid&quot;,
            class: &quot;fa fa-fw fa-th&quot;
        }, {
            click: &quot;setProvider(2)&quot;,
            hide: &quot;map.provider === 2 || map.provider === 0&quot;,
            tooltip: &quot;google&quot;,
            class: &quot;fa fa-fw fa-google&quot;
        }
    ]
}</code></pre>
<p>To customize these buttons you can comment out the lines of the button you want to hide or extend the list by adding new objects with the same structure.</p>
<p>When you add new buttons, an event with the name you define in the click field is sent every time the button is clicked.</p>
<p>You can use location: ‘left’ to align the buttons to the left, and use location: ‘right’ or nothing to align the buttons to the right side.</p>
<pre><code>{
    click: a string with the event name you want to trigger,
    hide: a condition to hide the button (this value is optional),
    tooltip: a string with the operator description, to show as a tooltip,
    class: a fontawesome class to define the icon,
    location: where to align the button, if not defined, the button goes to the right
}</code></pre>
<div class="page-break"></div>
<h3 id="controlcustombuttons">ControlCustomButtons</h3>
<p><img class="w80px" src="./layout-doc-imgs/new-img/controlbuttons2.png" alt="controlbuttons2" /></p>
<p>The buttons over the zoom in and zoom out can be customized the same way the mainoptions custom buttons.</p>
<p>This is the default ControlCustomButtons:</p>
<pre><code>{    
    &quot;ControlCustomButtons&quot;: [
        {
            click: &#39;widgets.geocoding.toggle()&#39;,
            tooltip: &#39;searchAddress&#39;,
            class: &#39;fa fa-fw fa-search&#39;
        },
        {
            click: &#39;!geolocating &amp;&amp; geolocate()&#39;,
            hide: &#39;geolocating&#39;,
            tooltip: &#39;geolocation&#39;,
            class: &#39;fa fa-fw fa-map-marker&#39;
        },
        {
            click: &#39;!geolocating &amp;&amp; geolocate()&#39;,
            hide: &#39;!geolocating&#39;,
            tooltip: &#39;geolocation&#39;,
            class: &#39;fa fa-fw fa-spinner ng-class:{&quot;fa-spin&quot;: geolocating}&#39;
        }
    ]
}</code></pre>
<p>To customize this buttons you can comment out the lines of the button you want to hide or extend the list by adding new objects with the same structure.</p>
<pre><code>{
    click: a string with the event name you want to trigger,
    hide: a condition to hide the button (this value is optional),
    tooltip: a string with the operator description, to show as a tooltip,
    class: a fontawesome class to define the icon
}</code></pre>
<h2 id="custom-logo">Custom Logo</h2>
<p>You can easily customize the logo showed in the aside by setting a new CSS style to the loading element. Just add this code to the styles part of your html file:</p>
<pre><code>#ez3d-logo {
    background-image: url(path-to-your-png-logo) !important;
    background-size: 140px !important;
    background-position: 40px center !important;
    background-repeat: no-repeat !important;
}</code></pre>
<p>Note you should use the <strong>!important</strong> attribute to overwrite the 3DLayout styles.</p>
<p>Please use a transparent background png for better results.</p>
<h2 id="custom-loading-animation">Custom Loading Animation</h2>
<p>You can easily customize the loading animation showed when starting the 3DLayout by setting a new CSS style to the loading element. Just add this code to the styles part of your html file:</p>
<pre><code>#ez3d-loader {
    background-image: url(path-to-your-animated-gif) !important;
    background-size: auto 75% !important;
    background-position: center center !important;
    background-repeat: no-repeat !important;
}</code></pre>
<p>Note you should use the <strong>!important</strong> attribute to overwrite the 3DLayout styles.</p>
<p>Please use a transparent background animated gif or png for better results.</p>
<h2 id="custom-logo-in-tutorial-section">Custom Logo in tutorial section</h2>
<p>You can easily customize the logo showed in the tutorial section by setting a new CSS style to the loading element. Just add this code to the styles part of your html file:</p>
<pre><code>#ez3d-logo-tuto {
    background: url(path-to-your-png-logo) top center no-repeat !important;
    background-size: auto 75px !important;
}</code></pre>
<h2 id="customize-go-back-button-in-the-tutorial-menu">Customize Go back button in the tutorial menu</h2>
<p>If you want to hide the go-back button you can use this css declaration:</p>
<pre><code>#ez3d-goback-tuto {
  display: none;
}</code></pre>
<p>Or you can modify more in deep the href of the element via javascript by using the id: ‘ez3d-goback-tuto’</p>
<div class="page-break"></div>
<div class="page-break"></div>
<h1 id="changelog">Changelog</h1>
<h2 id="section">[2.15.0] - 2017-02-01 - ?????????????????????????</h2>
<h3 id="added">Added</h3>
<p>Added a layout rule to limit maximum building height.You can read about this new feature in the <a href="#maxbuildingheight">maxBuildingHeight</a> section.</p>
<p>!!!!! FALTAN DATOS !!!!!!!</p>
<h2 id="section-1">[2.11.0] - 2016-11-04</h2>
<h3 id="changed">Changed</h3>
<p>Added two new imagery provider: Bing and Digital Globe.</p>
<p>Removed one imagery provider: Cyclomedia.</p>
<h3 id="fixed">Fixed</h3>
<p>Some minor fixes.</p>
<h2 id="section-2">[2.10.0] - 2016-10-21</h2>
<h3 id="added-1">Added</h3>
<p><strong>Subareas feature</strong>. You can read about this new feature in the <a href="#subareas">Subareas</a> section.</p>
<p>New **Subarea related API calls“. You can read about this new feature in the <a href="#subarea-related-functions">Subarea related functions</a> section.</p>
<p><strong>Keepout height calculations</strong> explanation. You can read about how keepout heights are calculated in the <a href="#keepout-height-calculations">Keepout height calculations</a> section.</p>
<p><strong>Invisible keepout feature</strong>. You can read about this new feature in the <a href="#invisible-keepouts">Invisible keepouts</a> section.</p>
<p><strong>Custom Alert feature</strong>. You can read about this new feature in the <a href="#customalert-event">CustomAlert event</a> section.</p>
<p><strong>Coordinate Systems</strong> explained. You can read about this in the <a href="#layout-coordinate-systems">Layout Coordinate Systems</a> section.</p>
<h3 id="fixed-1">Fixed</h3>
<p>Fixed an issue preventing to delete first point on building, keepout or subarea creation.</p>
<h3 id="deprecated">Deprecated</h3>
<p>We find a typo error in the name of a function:</p>
<p><em>getModulesSructureByArea</em> becomes <em>getModulesStructureByArea</em></p>
<p><strong>getBuildingInfo</strong><br />
verticesDeg attribute will be deprecated</p>
<p><strong>getBuildingPosition</strong><br />
center attribute will be deprecated &gt; becomes centerDeg<br />
vertices attribute will be deprecated</p>
<p><strong>getAreaInfo</strong><br />
areaMCoords will be deprecated &gt; becomes verticesMCoords,<br />
areaOffsetMCoords will be deprecated &gt; becomes verticesOffsetMCoords</p>
<blockquote>
<p>The old names still works but is recommended to update your code.</p>
</blockquote>
<h3 id="changed-1">Changed</h3>
<p>Some API calls were updated to reflect subarea feature. <em>GetLayoutData</em>, <em>getNumberOfModules</em>, <em>GetPower</em>, <em>getBuildingInfo</em> and <em>getAreaInfo</em> were changed to add subarea information.</p>
<h2 id="section-3">[2.9.1] - 2016-09-19</h2>
<h3 id="fixed-2">Fixed</h3>
<p>Fix tutorial to show new features on building creation (auto calculated point)</p>
<h2 id="section-4">[2.9.0] - 2016-09-18</h2>
<h3 id="fixed-3">Fixed</h3>
<p>Fixed a bug that prevented all buildings to be removed from a project.</p>
<p>Fixed some minor css issues</p>
<h2 id="section-5">[2.8.0] - 2016-09-14</h2>
<h3 id="changed-2">Changed</h3>
<p>Improved country detection internal functions.</p>
<h2 id="section-6">[2.7.0] - 2016-09-09</h2>
<h2 id="added-2">added</h2>
<p><strong>Tutorial mode</strong> access information. You can read about this new feature in the <a href="#tutorial-mode">Tutorial mode</a> section.</p>
<p><strong>Custom Logo in tutorial</strong> section. You can read about this new feature in the <a href="#custom-logo-in-tutorial-section">Custom Logo in tutorial section</a> section.</p>
<p><strong>Customize Go back button</strong> in the tutorial menu. You can read about this new feature in the <a href="#customize-go-back-button-in-the-tutorial-menu">Customize Go back button in the tutorial menu</a> section.</p>
<p><strong>azimuthOffset</strong> option to define your prefered convention for south faced modules. You can read about this new option in the <a href="#azimuthoffset">azimuthOffset</a></p>
<p>Roof inclination in degrees is showed in building information panel.</p>
<h3 id="changed-3">Changed</h3>
<p>New feature to add vertices on building and keepout creation. Now when 3 points are entered, the fourth one is calculated automatically (drawed in yellow) to help the creation of regular buildings. Just press “next step” when the yellow lines appears to accept the fourth point, or click again in the canvas to enter another point and go ahead with an irregular shape.</p>
<h3 id="fixed-4">Fixed</h3>
<p>Minor problems in the keepout and trees lists has been fixed. Now select and edit objects is easier.</p>
<h2 id="section-7">[2.6.0] - 2016-09-01</h2>
<h3 id="added-3">added</h3>
<p>Some minor GUI changes to clarify the workflow.</p>
<p>Two new showcase options, with and without camera spining. You can read a description of this options in the <a href="#showcase-mode">Showcase mode</a> section.</p>
<p>New <strong>perspective</strong>, <strong>spin</strong> and <strong>readonly</strong> options. You can read a description of this options in the <a href="#special-behaviours">Special Behaviours</a> section.</p>
<p>Custom Logo. You can read about this new feature in the <a href="#custom-logo">Custom Logo</a> section.</p>
<p>Custom Loading Animation. You can read about this new feature in the <a href="#custom-loading-animation">Custom Loading Animation</a> section.</p>
<h3 id="changed-4">changed</h3>
<p>Navigation panel, save button and building index now becomes disabled when creating a building.</p>
<p>Undo, redo and save buttons in mainoptions becomes custom buttons. You can read a description of this new custom buttons in the <a href="#mainoptionscustombuttons">MainoptionsCustomButtons</a> section.</p>
<p>A helper message is showed when roof types are restricted due to irregular buildings. Also, restricted roof types are shown disabled.</p>
<p>A dialog window is showed when vertices or roof is edited, to alert the user about the reset of the building.</p>
<p><em>Area offset</em> now is called <strong>Edge Zone</strong></p>
<p><em>Building height</em> now is called <strong>Gutter height</strong> as it doesn’t count the roof height.</p>
<h3 id="fixed-5">fixed</h3>
<p>Some errata in the pdf (added measure units for all values)</p>
<p>Fix style for loading animation to adjust to window size.</p>
<h3 id="deprecated-1">deprecated</h3>
<p>The <em>display</em> option is deprecated, now it’s called <strong>perspective</strong>. Anyway, it still works with the old naming.</p>
<p>The layout Url extension “/true” is deprecated. You can read a description of the new extensions in the <a href="#showcase-mode">Showcase mode</a> section. Anyway, it still works with the old naming.</p>
<!--   Template to add a version to the changelog

## [2.5.0] - 2016-08-01

### added

### changed

### deprecated

### removed

### fixed

### security

-->
</body>
</html>
